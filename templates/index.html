<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Ferramenta simples para testar endpoints da API Investidor10 com URL de carteira pública.">
    <meta property="og:title" content="Investidor10 API Client">
    <meta property="og:description" content="Interaja rapidamente com os endpoints da API Investidor10 informando as URLs públicas da sua carteira.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://investidor10.com.br/">
    <meta property="og:image" content="https://investidor10.com.br/static/logo-investidor10.png">
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Investidor10 API Client",
        "url": "https://investidor10.com.br/",
        "applicationCategory": "FinanceApplication",
        "operatingSystem": "Any",
        "description": "Ferramenta web para testar os endpoints da API Investidor10 usando URLs públicas do serviço.",
        "creator": {
            "@type": "Organization",
            "name": "Investidor10"
        }
    }
    </script>
    <title>Investidor10 API Client</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        #container {
            max-width: 700px;
            margin: auto;
        }


        textarea {
            width: 100%;
            height: 200px;
        }

        input[type="text"] {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
        }

        button {
            margin-right: 5px;
        }

        .section {
            margin-top: 20px;
        }

        .desc {
            font-size: 0.9em;
            color: #555;
        }

        #output {
            border: 1px solid #ddd;
            background: #f9f9f9;
            padding: 10px;
            min-height: 200px;
            white-space: pre-wrap;
        }

        #loading {
            display: none;
            font-style: italic;
            color: #007bff;
        }
    </style>
    <script>
        async function callAPI(endpoint) {
            const urlInput = endpoint === 'wallet-entries' ? 'walletEntriesUrl' : 'walletUrl';
            const url = document.getElementById(urlInput).value.trim();
            if (!url && endpoint !== 'test') {
                alert('Please provide the URL.');
                return;
            }

            if (endpoint !== 'test') {
                // persist URL for future visits
                localStorage.setItem(urlInput, url);
            }

            const params = new URLSearchParams();
            if (endpoint === 'wallet-entries') {
                params.append('wallet_entries_url', url);
            } else if (endpoint !== 'test') {
                params.append('wallet_url', url);
            }

            document.getElementById('loading').style.display = 'block';
            document.getElementById('output').textContent = '';
            try {
                const response = await fetch('/' + endpoint + '?' + params.toString());
                const text = await response.text();
                try {
                    const json = JSON.parse(text);
                    document.getElementById('output').textContent = JSON.stringify(json, null, 2);
                } catch {
                    document.getElementById('output').textContent = text;
                }
            } catch (err) {
                document.getElementById('output').textContent = 'Error: ' + err;
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        }

        // preload stored values on first load
        window.addEventListener('DOMContentLoaded', () => {
            const wallet = localStorage.getItem('walletUrl');
            const entries = localStorage.getItem('walletEntriesUrl');
            if (wallet) document.getElementById('walletUrl').value = wallet;
            if (entries) document.getElementById('walletEntriesUrl').value = entries;
        });
    </script>
</head>
<body>
    <div id="container">
        <h1>Investidor10 API Client</h1>
        <p>Fill in your public wallet URLs and choose an endpoint.</p>

        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 120 40'%3E%3Crect width='120' height='40' fill='%23007bff' rx='6'/%3E%3Ctext x='60' y='26' font-size='16' text-anchor='middle' fill='white' font-family='Arial, sans-serif'%3EInvestidor10%3C/text%3E%3C/svg%3E" alt="Investidor10 banner" loading="lazy" style="max-width: 100%; height: auto; margin: 20px 0;">

        <div class="section">
            <h3>Wallet URL</h3>
            <input type="text" id="walletUrl" placeholder="Wallet URL">
            <button onclick="callAPI('assets')">/assets</button>
            <button onclick="callAPI('data-com')">/data-com</button>
            <p class="desc">/assets returns the asset tables. /data-com lists upcoming dividend dates.</p>
        </div>

        <div class="section">
            <h3>Wallet Entries URL</h3>
            <input type="text" id="walletEntriesUrl" placeholder="Wallet Entries URL">
            <button onclick="callAPI('wallet-entries')">/wallet-entries</button>
            <p class="desc">/wallet-entries provides your order history.</p>
        </div>

        <div class="section">
            <h3>Misc</h3>
            <button onclick="callAPI('test')">/test</button>
            <p class="desc">Simple health check endpoint.</p>
        </div>

        <div class="section">
            <h3>Results</h3>
            <p id="loading">Loading...</p>
            <pre id="output"></pre>
        </div>

        <div class="section">
            <h3>Connect</h3>
            <p class="desc">Siga-nos para novidades e suporte.</p>
            <p>
                <a href="https://www.linkedin.com/in/gustavoaperin/" target="_blank" rel="noopener">LinkedIn</a> ·
                <a href="https://github.com/Bobagi/investidor10" target="_blank" rel="noopener">GitHub</a>
            </p>
        </div>
    </div>
</body>
</html>
